# Proposal: 助手工作区集成

## Summary

为助手管理添加工作区目录支持，实现 SPEC-002 中定义的工作区功能。

## Why

当前系统的助手管理只有基本的 CRUD 操作，缺少工作区目录管理。SPEC-002 定义了助手应该有对应的工作区目录，用于存储配置文件和文档。

**核心理解**：
- **创建助手 = 创建工作区** - 本质上是创建一个目录结构
- **管理助手 = 管理配置** - 数据库表存储所有配置
- **角色是配置项** - 不是需要"创建"的实体，而是配置到助手上的引用

## What Changes

### 包含
- 添加 `workspace_path` 字段到 `assistants` 表
- 创建工作区服务（创建/删除目录）
- 生成 MCP 配置文件
- 修改助手创建/删除流程

### 不包含
- 不调用 PromptX 创建角色（角色是配置项）
- 不修改文档处理逻辑
- 不修改对话系统

## Design

详见 [design.md](./design.md)

## Tasks

详见 [tasks.md](./tasks.md)

## Risks

1. **文件系统权限**：工作区目录创建可能因权限问题失败
   - 缓解：添加错误处理和回滚机制

2. **目录清理**：删除助手时需要确保工作区目录被正确删除
   - 缓解：使用事务性操作，先删除目录再删除数据库记录

## Timeline

预计 1-2 天完成实现和测试。
